<html>
	<head>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=default'></script>
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
		<style>
			h1 {
				text-align: center;
			}

			.container {
				margin: 0 auto;
				padding: 60px 20%;
			}

			figure {
				text-align: center;
			}

			img {
				display: inline-block;
			}

			body {
				font-family: 'Inter', sans-serif;
			}
		</style>
	</head>
	<body>
		<div class="container">
		<h1>CS184/284A Spring 2025 Homework 4 Write-Up</h1>
		<div style="text-align: center;">Names: </div>

		<br>

		Link to webpage: <a href="https://andywa-ng.github.io/hw-webpages-andy/hw4/index.html">https://andywa-ng.github.io/hw-webpages-andy/hw4/index.html</a>

		<br>

		Link to GitHub repository: <a href="https://github.com/cal-cs184-student/sp25-hw4-miya">https://github.com/cal-cs184-student/sp25-hw4-miya</a>

		<!--
		We've already added one heading per part, to make your write-up as navigable when grading. Please fit your write-up within these sections!
		-->

		<h2>Overview</h2>
		Give a high-level overview of what you implemented in this homework. Think about what you've built as a whole. Share your thoughts on what interesting things you've learned from completing the homework.

		<h2>Part 1: Masses and springs</h2>

		<h3>Implementing a grid of masses and springs</h3>
		<ul>
			<li>The cloth simulation uses a mass-spring system where the cloth is discretized into a grid of point masses connected by springs.</li>
			<li>The implementation creates an evenly spaced <code>num_width_points x num_height_points</code>  grid of point masses spanning the cloth's width and height.</li>
			<li>For horizontal orientation, point masses vary in the xz-plane with a fixed y-coordinate of 1.0, while vertical orientation varies in the xy-plane with a small random z-offset for stability.</li>
			<li>Three types of springs connect these masses: structural springs link adjacent masses horizontally and vertically, shearing springs connect diagonal neighbors, and bending springs span two masses apart in both directions. </li>
		</ul>

		<br>

		<div style="display: flex; flex-direction: column; align-items: center;">
			<table style="width: 100%; text-align: center; border-collapse: collapse;">
			  <tr>
				<td style="text-align: center;">
				  <img src="task1_all_constraints.png" width="400px"/>
				  <figcaption>All constraints</figcaption>
				</td>
				<td style="text-align: center;">
				  <img src="task1_no_shearing.png" width="400px"/>
				  <figcaption>No shearing constraints</figcaption>
				</td>
			  </tr>
			  <tr>
				<td style="text-align: center;">
				  <img src="task1_shearing_constraints.png" width="400px"/>
				  <figcaption>Only shearing constraints</figcaption>
				</td>
			  </tr>
			</table>
		</div>

		<h2>Part 2: Simulation via numerical integration</h2>

		<h3>Spring Constant (ks)</h3>
		<ul>
			<li><strong>Low ks</strong>: Creates stretchy, elastic behavior with exaggerated deformations. Cloth behaves like rubber, bouncing and waving significantly before settling.</li>
			<li><strong>High ks</strong>: Results in stiff, rigid cloth that maintains shape but moves more abruptly. Quickly reaches equilibrium with minimal stretching.</li>
		</ul>

		<div style="display: flex; flex-direction: column; align-items: center;">
			<table style="width: 100%; text-align: center; border-collapse: collapse;">
			  <tr>
				<td style="text-align: center;">
				  <img src="task2_lowks.png" width="400px"/>
				  <figcaption>Low ks</figcaption>
				</td>
				<td style="text-align: center;">
				  <img src="task2_highks.png" width="400px"/>
				  <figcaption>High ks</figcaption>
				</td>
			  </tr>
			</table>
		</div>

		<h3>Density</h3>
		<ul>
			<li><strong>Low density</strong>: Creates lightweight cloth that responds quickly to forces but may appear unrealistic. Settles rapidly with minimal draping.</li>
			<li><strong>High density</strong>: Produces heavy, well-draped appearance with pronounced gravitational effects. Shows more stretching under its own weight and slower movement.</li>
		</ul>

		<div style="display: flex; flex-direction: column; align-items: center;">
			<table style="width: 100%; text-align: center; border-collapse: collapse;">
			  <tr>
				<td style="text-align: center;">
				  <img src="task2_lowdensity.png" width="400px"/>
				  <figcaption>Low density</figcaption>
				</td>
				<td style="text-align: center;">
				  <img src="task2_highdensity.png" width="400px"/>
				  <figcaption>High density</figcaption>
				</td>
			  </tr>
			</table>
		</div>

		<h3>Damping</h3>
		<ul>
			<li><strong>Low damping</strong>: Exhibits persistent oscillations and ripples, taking longer to settle. Suitable for light, flowing fabrics.</li>
			<li><strong>High damping</strong>: Quickly stabilizes with minimal secondary motion. Can appear artificially stiff but useful for simulating thick materials.</li>
		</ul>

		<figure>
			<img src="task2_pinned4.png" style="width:70%"/>
			<figcaption>Final resting state of pinned4</figcaption>
		</figure>

		<h2>Part 3: Handling collisions with other objects</h2>

		<h3>Sphere Collisions</h3>
		
		<h4>1. Collision Detection:</h4>
		<ul>
			<li>Calculate vector from sphere's origin to point mass</li>
			<li>Compare squared distance to sphere's squared radius</li>
			<li>If distance is less than or equal to radius, collision has occurred</li>
		</ul>

		<h4>2. Collision Response:</h4>
		<ul>
			<li>Normalize the direction vector to get unit vector from sphere center to point mass</li>
			<li>Calculate tangent point on sphere surface: origin + direction * radius</li>
			<li>Compute correction vector from last_position to tangent point</li>
			<li>Apply correction scaled by (1-friction) to maintain energy loss due to friction</li>
		</ul>

		<h3>Plane Collisions</h3>
		<h4>1. Crossing Detection:</h4>
		<ul>
			<li>Calculate signed distances from plane to both current and last positions</li>
			<li>If signs differ (product is negative), point mass has crossed plane</li>
		</ul>

		<h4>2. Collision Response:</h4>
		<ul>
			<li>Calculate intersection point using ray-plane intersection</li>
			<li>Add small offset in normal direction to prevent numerical issues</li>
			<li>Apply friction-scaled correction to move point mass back</li>
		</ul>

		<h3>Spring Constant (ks) Analysis</h3>

		<div style="display: flex; flex-direction: column; align-items: center;">
			<table style="width: 100%; text-align: center; border-collapse: collapse;">
			  <tr>
				<td style="text-align: center;">
				  <img src="task3_lowks.png" width="400px"/>
				  <figcaption>Cloth resting on sphere with ks=500</figcaption>
				</td>
				<td style="text-align: center;">
				  <img src="task3_regks.png" width="400px"/>
				  <figcaption>Cloth resting on sphere with ks=5000</figcaption>
				</td>
			  </tr>
			  <tr>
				<td style="text-align: center;">
				  <img src="task3_highks.png" width="400px"/>
				  <figcaption>Cloth resting on sphere with ks=50000</figcaption>
				</td>
			  </tr>
			</table>
		</div>

		<h4>Analysis of Different ks Values:</h4>
		<dl>
			<dt><strong>ks = 500 (Low):</strong></dt>
			<dd>
				<ul>
					<li>Cloth appears very stretchy</li>
					<li>Significant deformation around sphere</li>
					<li>Less accurate representation of fabric behavior</li>
				</ul>
			</dd>

			<dt><strong>ks = 5000 (Default):</strong></dt>
			<dd>
				<ul>
					<li>Balanced behavior between rigidity and flexibility</li>
					<li>Natural-looking draping over sphere</li>
					<li>Realistic cloth-like behavior</li>
				</ul>
			</dd>

			<dt><strong>ks = 50000 (High):</strong></dt>
			<dd>
				<ul>
					<li>Very stiff cloth behavior</li>
					<li>Maintains shape more rigidly</li>
					<li>Less natural draping but better shape preservation</li>
				</ul>
			</dd>
		</dl>

		<figure>
			<img src="task3_plane.png" style="width:70%"/>
			<figcaption>Cloth resting on plane</figcaption>
		</figure>


		<h2>Part 4: Handling self-collisions</h2>
		Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

		<h2>Part 5: Shaders</h2>
		Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

		<h2>(Optional) Part 6: Extra Credit - Additional cloth simulation features!</h2>
		Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		
		<h2>Additional Notes (please remove)</h2>
		<ul>
			<li>You can also add code if you'd like as so: <code>code code code</code></li>
			<li>If you'd like to add math equations, 
				<ul>
					<li>You can write inline equations like so: \( a^2 + b^2 = c^2 \)</li>
					<li>You can write display equations like so: \[ a^2 + b^2 = c^2 \]</li>
				</ul>
			</li>
		</ul>
		</div>
	</body>
</html>